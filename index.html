<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSLC | Professional Lawn Care</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .slider-container { position: relative; width: 100%; aspect-ratio: 16/9; overflow: hidden; border-radius: 1.5rem; }
        .img-before { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        .img-after { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; clip-path: inset(0 0 0 50%); }
        .slider-handle { position: absolute; top: 0; bottom: 0; left: 50%; width: 4px; background: white; cursor: ew-resize; transform: translateX(-50%); z-index: 10; }
        .slider-handle::after { content: '‚Üî'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 44px; height: 44px; background: white; color: #166534; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        
        /* This is what keeps them separate */
        .page-view { display: none; }
        .page-view.active { display: block; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-10">

    <nav class="bg-white border-b p-6 sticky top-0 z-50 shadow-sm">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-extrabold text-green-800 tracking-tighter">NSLC</h1>
            <div class="flex bg-slate-100 p-1 rounded-xl">
                <button onclick="showPage('client')" id="tab-client" class="px-4 py-2 text-[10px] font-bold uppercase rounded-lg transition-all bg-white shadow-sm text-green-700">Client View</button>
                <button onclick="showPage('auth')" id="tab-worker" class="px-4 py-2 text-[10px] font-bold uppercase rounded-lg transition-all text-slate-500">Worker Portal</button>
            </div>
        </div>
    </nav>

    <main class="max-w-md mx-auto p-6">

        <div id="page-client" class="page-view active space-y-8">
            <h2 class="text-3xl font-extrabold text-slate-900 leading-tight">Elite Results.<br><span class="text-green-600">Local Prices.</span></h2>
            <div class="slider-container shadow-2xl border-4 border-white" id="nslcSlider">
                <img src="pictures/illam.jfif" alt="Before" class="img-before">
                <img src="pictures/illam2.jfif" alt="After" class="img-after">
                <div class="slider-handle"></div>
            </div>
            <a href="tel:0400000000" class="block w-full bg-green-700 text-white text-center py-4 rounded-xl font-extrabold">Call for Estimate</a>
        </div>

        <div id="page-auth" class="page-view space-y-6 pt-10 text-center">
            <h2 class="font-bold text-slate-400 uppercase text-xs tracking-widest">Enter Worker PIN</h2>
            <input type="password" id="pinInput" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="4" class="w-full p-6 text-center text-4xl border rounded-2xl tracking-widest outline-none bg-white">
            <button onclick="checkPin()" class="w-full bg-slate-800 text-white py-4 rounded-xl font-bold">Unlock</button>
        </div>

        <div id="page-worker" class="page-view space-y-6">
            <div class="bg-green-50 p-6 rounded-3xl border border-green-100">
                <h3 class="font-bold text-green-800 mb-4">üá¶üá∫ AUD Job Calculator</h3>
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <input type="number" id="sqm" oninput="calc()" placeholder="m¬≤" class="w-full p-3 border rounded-xl">
                    <input type="number" id="complex" oninput="calc()" value="1" min="1" max="3" class="w-full p-3 border rounded-xl">
                </div>
                <div class="space-y-2 mb-4 text-sm">
                    <label class="flex justify-between bg-white p-3 rounded-xl border"><span>üåø Hedge</span><input type="checkbox" id="addHedge" onchange="calc()"></label>
                    <label class="flex justify-between bg-white p-3 rounded-xl border"><span>‚úÇÔ∏è Whacker</span><input type="checkbox" id="addWhacker" onchange="calc()"></label>
                    <label class="flex justify-between bg-white p-3 rounded-xl border"><span>ü§≤ Weeding</span><input type="checkbox" id="addWeeding" onchange="calc()"></label>
                </div>
                <p class="text-2xl font-black text-green-700">$<span id="suggested">0</span></p>
            </div>

            <div class="bg-white p-6 rounded-3xl shadow-xl space-y-4">
                <input type="text" id="workerName" placeholder="Worker" class="w-full p-4 bg-slate-50 border rounded-2xl">
                <input type="text" id="clientName" placeholder="Client Name" class="w-full p-4 bg-slate-50 border rounded-2xl">
                <input type="text" id="clientAddress" placeholder="Address" class="w-full p-4 bg-slate-50 border rounded-2xl">
                <textarea id="serviceList" rows="3" placeholder="Notes..." class="w-full p-4 bg-slate-50 border rounded-2xl"></textarea>
                <input type="number" id="price" class="w-full p-4 border rounded-2xl font-bold text-green-700">
                <button onclick="submitJob()" id="btn" class="w-full bg-green-700 text-white py-5 rounded-2xl font-bold">Sync to Database</button>
            </div>
        </div>

    </main>

    <script>
        const MASTER_PIN = "0912";
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxe5BbOmFDD1wTz1j757SkNZQgGHUgCi9bE2kTPmEgFLPE82n2HsWHFnxLB8X7UhEdg/exec";

        function showPage(pageId) {
            document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            
            // UI Button styling
            const cBtn = document.getElementById('tab-client');
            const wBtn = document.getElementById('tab-worker');
            if(pageId === 'client') {
                cBtn.className = "px-4 py-2 text-[10px] font-bold uppercase rounded-lg bg-white shadow-sm text-green-700";
                wBtn.className = "px-4 py-2 text-[10px] font-bold uppercase rounded-lg text-slate-500";
            } else {
                wBtn.className = "px-4 py-2 text-[10px] font-bold uppercase rounded-lg bg-white shadow-sm text-green-700";
                cBtn.className = "px-4 py-2 text-[10px] font-bold uppercase rounded-lg text-slate-500";
            }
        }

        function checkPin() {
            if(document.getElementById('pinInput').value === MASTER_PIN) {
                showPage('worker');
            } else { alert("Wrong PIN"); }
        }

        function calc() {
            const sqm = document.getElementById('sqm').value || 0;
            const complexity = document.getElementById('complex').value || 1;
            let total = (35 + (sqm * 0.05)) * complexity;
            if(document.getElementById('addHedge').checked) total += 25;
            if(document.getElementById('addWhacker').checked) total += 15;
            if(document.getElementById('addWeeding').checked) total += 10;
            document.getElementById('suggested').innerText = Math.round(total);
            document.getElementById('price').value = Math.round(total);
        }

        async function submitJob() {
            const payload = {
                worker: document.getElementById('workerName').value,
                name: document.getElementById('clientName').value,
                address: document.getElementById('clientAddress').value,
                services: document.getElementById('serviceList').value,
                price: document.getElementById('price').value
            };
            try {
                await fetch(WEB_APP_URL, { method: "POST", mode: "no-cors", body: JSON.stringify(payload) });
                alert("Synced!"); location.reload();
            } catch (e) { alert("Error!"); }
        }

        // Slider logic
        const slider = document.getElementById('nslcSlider');
        const handle = slider.querySelector('.slider-handle');
        const imgAfter = slider.querySelector('.img-after');
        function moveSlider(e) {
            const rect = slider.getBoundingClientRect();
            let pageX = e.pageX || (e.touches ? e.touches[0].pageX : 0);
            let percent = ((pageX - rect.left) / rect.width) * 100;
            percent = Math.max(0, Math.min(100, percent));
            handle.style.left = percent + '%';
            imgAfter.style.clipPath = `inset(0 0 0 ${percent}%)`;
        }
        slider.addEventListener('mousemove', moveSlider);
        slider.addEventListener('touchmove', (e) => { moveSlider(e); e.preventDefault(); }, {passive: false});
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSLC | Professional Lawn Care</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .slider-container { position: relative; width: 100%; aspect-ratio: 16/9; overflow: hidden; border-radius: 1.5rem; }
        .img-before { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        .img-after { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; clip-path: inset(0 0 0 50%); }
        .slider-handle { position: absolute; top: 0; bottom: 0; left: 50%; width: 4px; background: white; cursor: ew-resize; transform: translateX(-50%); z-index: 10; }
        .slider-handle::after { content: 'â†”'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 44px; height: 44px; background: white; color: #166534; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-10 text-slate-900">

    <nav class="bg-white border-b p-6 sticky top-0 z-50 shadow-sm">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-extrabold text-green-800 tracking-tighter">NSLC</h1>
            </div>
            <div class="flex bg-slate-100 p-1 rounded-xl">
                <button onclick="switchTab('public')" id="btn-public" class="px-3 py-1.5 text-[10px] font-bold uppercase rounded-lg transition-all bg-white shadow-sm text-green-700">Client View</button>
                <button onclick="switchTab('worker')" id="btn-worker" class="px-3 py-1.5 text-[10px] font-bold uppercase rounded-lg transition-all text-slate-500">Worker Log</button>
            </div>
        </div>
    </nav>

    <main class="max-w-md mx-auto p-6">

        <div id="public" class="tab-content active space-y-8">
            <h2 class="text-3xl font-extrabold text-slate-900 leading-tight">Elite Results. <br><span class="text-green-600">Local Prices.</span></h2>
            <div class="slider-container shadow-2xl border-4 border-white" id="nslcSlider">
                <img src="https://images.unsplash.com/photo-1558905619-1735bc2f19d2?q=80&w=800" class="img-before">
                <img src="https://images.unsplash.com/photo-1592150621344-828ec189028b?q=80&w=800" class="img-after">
                <div class="slider-handle"></div>
            </div>
            <div class="bg-green-700 p-6 rounded-2xl text-white">
                <p class="font-bold mb-1">Affordable Australian Lawn Care</p>
                <p class="text-sm opacity-90 mb-4">Quality service without the premium price tag.</p>
                <a href="tel:0470419314" class="block w-full bg-white text-green-700 text-center py-3 rounded-xl font-bold">Call for Estimate</a>
            </div>
        </div>

        <div id="auth" class="tab-content space-y-4 pt-10">
            <h2 class="text-center font-bold text-slate-400 uppercase text-xs">Enter Worker PIN</h2>
            <input type="password" id="pinInput" placeholder="â€¢â€¢â€¢â€¢" maxlength="4" class="w-full p-4 text-center text-3xl border rounded-2xl tracking-widest outline-none focus:border-green-600">
            <button onclick="checkPin()" class="w-full bg-slate-800 text-white py-4 rounded-xl font-bold active:scale-95 transition-all">Unlock Portal</button>
        </div>

        <div id="worker" class="tab-content space-y-6">
            
            <div class="bg-green-50 p-6 rounded-3xl border border-green-100 shadow-sm">
                <h3 class="font-bold text-green-800 mb-4 flex items-center gap-2">ðŸ‡¦ðŸ‡º AUD Job Calculator</h3>
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div>
                        <label class="block text-[10px] uppercase font-bold text-green-600">Yard Size (mÂ²)</label>
                        <input type="number" id="sqm" oninput="calc()" placeholder="300" class="w-full p-2 border rounded-lg">
                    </div>
                    <div>
                        <label class="block text-[10px] uppercase font-bold text-green-600">Difficulty (1-3)</label>
                        <input type="number" id="complex" oninput="calc()" value="1" min="1" max="3" class="w-full p-2 border rounded-lg">
                    </div>
                </div>
                <p class="mt-4 text-2xl font-black text-green-700">Estimated: $<span id="suggested">0</span> <span class="text-sm font-normal">AUD</span></p>
                <p class="text-[10px] text-green-600 mt-1 italic">*Formula optimized for 30% below market average.</p>
            </div>

            <div class="bg-white p-6 rounded-3xl shadow-xl border border-slate-100 space-y-4">
                <h2 class="font-extrabold text-slate-800 text-lg">Log Completed Job</h2>
                <input type="text" id="workerName" placeholder="Worker Name" class="w-full p-4 bg-slate-50 border rounded-2xl outline-none focus:border-green-600">
                <input type="text" id="clientName" placeholder="Client & Address" class="w-full p-4 bg-slate-50 border rounded-2xl outline-none focus:border-green-600">
                <textarea id="serviceList" rows="3" placeholder="Services (e.g. Front mow, edges, weed spray)" class="w-full p-4 bg-slate-50 border rounded-2xl outline-none focus:border-green-600"></textarea>
                <div class="relative">
                    <span class="absolute left-4 top-4 font-bold text-slate-400">$</span>
                    <input type="number" id="price" placeholder="Total Charged (AUD)" class="w-full p-4 pl-8 bg-slate-50 border rounded-2xl font-bold text-green-700 outline-none focus:border-green-600">
                </div>
                <button onclick="submitJob()" id="btn" class="w-full bg-green-700 text-white py-5 rounded-2xl font-bold text-lg shadow-lg active:scale-95 transition-all">
                    Sync to NSLC Cloud
                </button>
            </div>
        </div>

    </main>

    <script>
        const MASTER_PIN = "0912"; 
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxe5BbOmFDD1wTz1j757SkNZQgGHUgCi9bE2kTPmEgFLPE82n2HsWHFnxLB8X7UhEdg/exec"; 

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            if(tab === 'worker') {
                document.getElementById('auth').classList.add('active');
            } else {
                document.getElementById('public').classList.add('active');
            }
        }

        function checkPin() {
            if(document.getElementById('pinInput').value === MASTER_PIN) {
                document.getElementById('auth').classList.remove('active');
                document.getElementById('worker').classList.add('active');
            } else {
                alert("Access Denied: Incorrect PIN");
                document.getElementById('pinInput').value = '';
            }
        }

        function calc() {
            const sqm = document.getElementById('sqm').value || 0;
            const complexity = document.getElementById('complex').value || 1;
            // Formula: $35 base (lowered) + $0.05 per m2 * complexity
            // Typical AU rates are $0.10-$0.15 per m2, so $0.05 is significantly cheaper.
            let total = (35 + (sqm * 0.05)) * complexity;
            document.getElementById('suggested').innerText = Math.round(total);
        }

        async function submitJob() {
            const btn = document.getElementById('btn');
            const payload = {
                worker: document.getElementById('workerName').value,
                name: document.getElementById('clientName').value,
                services: document.getElementById('serviceList').value,
                price: document.getElementById('price').value
            };
            if(!payload.name || !payload.worker) return alert("Worker and Client names required.");
            
            btn.disabled = true;
            btn.innerText = "Processing...";

            try {
                await fetch(WEB_APP_URL, {
                    method: "POST",
                    mode: "no-cors",
                    headers: { "Content-Type": "text/plain" },
                    body: JSON.stringify(payload)
                });
                alert("Successfully Synced to NSLC Spreadsheet!");
                location.reload();
            } catch (e) {
                alert("Connection Error.");
                btn.disabled = false;
                btn.innerText = "Retry Sync";
            }
        }

        // Slider logic
        const slider = document.getElementById('nslcSlider');
        const handle = slider.querySelector('.slider-handle');
        const imgAfter = slider.querySelector('.img-after');
        function moveSlider(e) {
            const rect = slider.getBoundingClientRect();
            let pageX = e.pageX || (e.touches ? e.touches[0].pageX : 0);
            let percent = ((pageX - rect.left) / rect.width) * 100;
            percent = Math.max(0, Math.min(100, percent));
            handle.style.left = percent + '%';
            imgAfter.style.clipPath = `inset(0 0 0 ${percent}%)`;
        }
        slider.addEventListener('mousemove', moveSlider);
        slider.addEventListener('touchmove', (e) => { moveSlider(e); e.preventDefault(); }, {passive: false});
    </script>
</body>
</html>
